<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>简单的天气查询</title>
</head>
<body>
<!--<input type="text" id="email">-->
<!--<label><input type="radio" name="weekday" id="monday" value="1"> Monday</label>-->
<!--<label><input type="radio" name="weekday" id="tuesday" value="2"> Tuesday</label>-->
<!--<script>-->
    <!--var input = document.getElementById("email");-->
    <!--input.value = '1638388435@qq.com';-->
<!--</script>-->
<!--<form id="login-form" method="post" onsubmit="return checkForm()">-->
    <!--<input type="text" id="username" name="username">-->
    <!--<input type="password" id="input-password">-->
    <!--<input type="hidden" id="md5-password" name="password">-->
    <!--<button type="submit">Submit</button>-->
<!--</form>-->
<!--<script>-->
    <!--function checkForm() {-->
        <!--var input_pwd = document.getElementById('input-password');-->
        <!--var md5_pwd = document.getElementById('md5-password');-->
        <!--// 把用户输入的明文变为MD5:-->
        <!--md5_pwd.value = toMD5(input_pwd.value);-->
        <!--// 继续下一步:-->
        <!--return true;-->
    <!--}-->
<!--</script>-->
<!--<form id="test-register" action="#" target="_blank" onsubmit="return checkRegisterForm()">-->
    <!--<p id="test-error" style="color:red"></p>-->
    <!--<p>-->
        <!--用户名: <input type="text" id="username" name="username">-->
    <!--</p>-->
    <!--<p>-->
        <!--口令: <input type="password" id="password" name="password">-->
    <!--</p>-->
    <!--<p>-->
        <!--重复口令: <input type="password" id="password-2">-->
    <!--</p>-->
    <!--<p>-->
        <!--<button type="submit">提交</button> <button type="reset">重置</button>-->
    <!--</p>-->
<!--</form>-->
<!--<script>-->
    <!--var-->
         <!--username = document.getElementById('username');-->
         <!--pw = document.getElementById('password');-->
         <!--pw1 = document.getElementById('password-2');-->
         <!--a = /[\w{3,10}]/;-->
         <!--b = /[.{6,20}]/;-->
    <!--if(a.test(username.value)&&b.test(pw)&&b.test(pw1)&&pw.value === pw1.value)){-->
        <!--alert('True!');-->
    <!--}else{-->
        <!--alert('False!');-->
    <!--}-->
<!--</script>-->
<!--<input type="file">-->
<!--<script>-->
    <!--var f = document.getElementById('test-file-upload');-->
    <!--var filename = f.value; // 'C:\fakepath\test.png'-->
    <!--if (!filename || !(filename.endsWith('.jpg') || filename.endsWith('.png') || filename.endsWith('.gif'))) {-->
        <!--alert('Can only upload image file.');-->
        <!--return false;-->
    <!--}-->
<!--</script>-->
<p>输入当前城市:<input type="text" id="city"></p>
<button type="submit" onclick="getWeather()">查询</button>
<p id="weatherInfo">所查询的信息为：</p>
<script>
    function getWeather(){
        let url = 'https://api.openweathermap.org/data/2.5/forecast?q=Beijing,cn&appid=800f49846586c3ba6e7052cfc89af16c';
        let city = document.getElementById('city');
        //let newURL = url + city.value;
        let newURL = 'https://api.openweathermap.org/data/2.5/forecast?q=Beijing,cn&appid=800f49846586c3ba6e7052cfc89af16c';
        console.log(newURL);
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function(){
            if(xhr.readyState === 4){
                if(xhr.status === 200){
                    return success(xhr.responseText);
                }else{
                    alert("!"+ xhr.status);
                }
            }else{
                alert(xhr.readyState);
            }
        }
        xhr.open('GET',newURL);
        xhr.send();
    }

    function success(data){
        let weather = document.getElementById('weatherInfo');
        let weatherInfo = JSON.parse(data);
        if(5>1){
            weather.innerHTML = '查询成功' + '<br>'+
                '当前城市：'+weatherInfo.data.city.name+ '<br>'+
                '天气：'+weatherInfo.data.list[0].weather[0].main
                // '气温：'+'最'+weatherInfo.data.forecast[0].high +'，最'+weatherInfo.data.forecast[0].low+'<br>'+
                // '天气：'+weatherInfo.data.forecast[0].type+'<br>'+
                // '风向：'+weatherInfo.data.forecast[0].fengxiang + weatherInfo.data.forecast[0].fengli+'<br>' +
                // '注意：'+weatherInfo.data.ganmao
            weather.innerText  = weatherInfo.innerHTML;
            //alert(weatherInfo.innerHTML);
        }else{
            weather.innerText  = 'false';
        }
    }
</script>
</body>
</html>